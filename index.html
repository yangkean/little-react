<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>little react</title>
  </head>
  <body>
    <div class="wrapper"></div>
  </body>
</html>

<script>
  class Component {
    constructor(props = {}) {
      // ‰øùÂ≠òÂ§ñÈÉ®‰º†ÂÖ•ÁöÑÈÖçÁΩÆÂèÇÊï∞
      this.props = props
    }

    // ‰øÆÊîπÁªÑ‰ª∂Áä∂ÊÄÅÂπ∂Âú®Áä∂ÊÄÅÊõ¥Êñ∞Êó∂Êõ¥Êñ∞ DOM ÂÖÉÁ¥†
    setState(state) {
      const oldEl = this.el
      this.state = state
      this.el = this.renderDOM()
      if(this.onStateChange) this.onStateChange(oldEl, this.el)
    }

    // ËøîÂõûÁªëÂÆöÂ•Ω‰∫ã‰ª∂ÁöÑ DOM ÂÖÉÁ¥†
    renderDOM() {
      // ÂæóÂà∞ DOM ÂÖÉÁ¥†Âπ∂ÁºìÂ≠ò
      this.el = createDOMFromString(this.render())

      // Â∞ÜÁªëÂÆöÂú®ÁªÑ‰ª∂Á±ª‰∏äÁöÑ‰∫ã‰ª∂Ê≥®ÂÜåÂà∞ DOM ÂÖÉÁ¥†‰∏ä
      if(this.onClick) {
        this.el.addEventListener('click', this.onClick.bind(this), false)
      }

      return this.el
    }
  }

  // DOM Â≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫ DOM ÂÖÉÁ¥†
  const createDOMFromString = (domString) => {
    const div = document.createElement('div')
    div.innerHTML = domString
    return div
  }

  // Â∞ÜÊ∏≤ÊüìÂ•ΩÁöÑÁªÑ‰ª∂ÊåÇËΩΩÂà∞È°µÈù¢‰∏äÔºåÂπ∂ÁõëÂê¨ÁªÑ‰ª∂Áä∂ÊÄÅ
  const mount = (component, wrapper) => {
    wrapper.appendChild(component.renderDOM())

    component.onStateChange = (oldEl, newEl) => {
      wrapper.insertBefore(newEl, oldEl)
      wrapper.removeChild(oldEl)
    }
  }

  /* ============== ‰ΩøÁî® ============= */
  class LikeButton extends Component {
    constructor(props) {
      super(props)
      this.state = {
        isLiked: false,
      }
    }

    onClick() {
      this.setState({
        isLiked: !this.state.isLiked
      })
    }

    render() {
      return `
        <button style="background-color:${this.props.bgColor}">
          <span>
            ${this.state.isLiked ? 'ÂèñÊ∂à' : 'ÁÇπËµû'}  
          </span>
          <span>üëç</span>
        </button>
      `
    }
  }

  class RedBlueButton extends Component {
    constructor(props) {
      super(props)
      this.state = {
        color: 'red'
      }
    }

    onClick() {
      this.setState({
        color: 'blue'
      })
    }

    render() {
      return `
        <button style="color: ${this.state.color}">${this.state.color}</button>
      `
    }
  }

  const wrapper = document.querySelector('.wrapper')
  mount(new LikeButton({ bgColor: 'red' }), wrapper)
  mount(new LikeButton(), wrapper)
  mount(new RedBlueButton(), wrapper)
</script>